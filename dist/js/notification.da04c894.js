import{g as N,c as $}from"./index.db9bc9a4.js";import{O as S,I as c,J as v,a3 as g,H as u,a6 as V,a7 as z,ac as y,L as n,K as s,R as i,M as f,N as B,T as m,F,a1 as G}from"./index.9ba2f0f9.js";const L={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},U=g("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208s208-93.31 208-208S370.69 48 256 48zm108.25 138.29l-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32l122.59-145.91a16 16 0 0 1 24.5 20.58z",fill:"currentColor"},null,-1),E=[U],H=S({name:"CheckmarkCircle",render:function(l,o){return c(),v("svg",L,E)}}),I={key:0},J=g("text",{style:{"font-weight":"500"}},"已读",-1),K={key:1},O=g("text",{style:{"margin-top":"20px"}},"暂无通知",-1),j=[O],C={__name:"notifyDisplay",props:["data"],emits:["markAsRead"],setup(x){const l=x;return(o,w)=>{const _=u("n-icon"),r=u("n-tag"),k=u("n-button"),h=u("n-card");return l.data!=null&&l.data.length!=0?(c(),v("div",I,[(c(!0),v(V,null,z(l.data,a=>(c(),y(h,{style:{"margin-bottom":"16px"},title:a.title,key:a.id},{"header-extra":n(()=>[a.isRead?(c(),y(r,{key:0,bordered:!1,type:"success"},{icon:n(()=>[s(_,{component:i(H)},null,8,["component"])]),default:n(()=>[J]),_:1})):(c(),y(k,{key:1,strong:"",secondary:"",onClick:A=>o.$emit("markAsRead",a.id)},{default:n(()=>[f("设为已读")]),_:2},1032,["onClick"]))]),footer:n(()=>[f(B(a.sentAt),1)]),default:n(()=>[f(" "+B(a.content)+" ",1)]),_:2},1032,["title"]))),128))])):(c(),v("div",K,j))}}},q={style:{"margin-right":"20px","margin-top":"20px"}},W={__name:"notification",setup(x){const l=m("all"),o=m(!0);F(()=>{a(o.value)});function w(){a(o.value)}const _=m(null),r=m(null),k=m(0);function h(){o.value=!o.value,a(o.value)}function a(d){d?N("/notifications/getAllNotifications",{},e=>{_.value=e.map(t=>({id:t.id,title:t.title,content:t.content,type:t.type,sentAt:t.sentAt,isRead:t.read}))}).then(()=>{console.log(_.value),A(l.value)}):N("/notifications/getAllUnreadNotifications",{},e=>{_.value=e.map(t=>({id:t.id,title:t.title,content:t.content,type:t.type,sentAt:t.sentAt,isRead:t.read}))}).then(()=>{A(l.value)})}function A(d){d=="all"?r.value=_.value:r.value=_.value.filter(e=>e.type==d),k.value=r.value.filter(e=>e.isRead==!1).length}function b(d){console.log(d),$("/notifications/markAsRead",{value:d},()=>{a(o.value)})}function M(){$("/notifications/markAllAsRead",{},()=>{a(o.value)})}return(d,e)=>{const t=u("n-button"),R=u("n-tab-pane"),T=u("n-tabs"),D=u("n-card");return c(),v("div",null,[s(D,{title:"通知中心",style:{"margin-top":"20px","min-height":"700px"}},{"header-extra":n(()=>[g("div",q,[i(o)?(c(),y(t,{key:0,strong:"",secondary:"",type:"info",onClick:h},{default:n(()=>[f(" 仅查看未读通知 ")]),_:1})):(c(),y(t,{key:1,strong:"",secondary:"",onClick:h},{default:n(()=>[f("查看全部通知")]),_:1})),s(t,{strong:"",secondary:"",type:"success",onClick:M,style:{"margin-left":"20px"},disabled:i(k)===0},{default:n(()=>[f(" 一键已读 ")]),_:1},8,["disabled"])])]),default:n(()=>[g("div",null,[s(T,{type:"line",animated:"",value:i(l),"onUpdate:value":[e[3]||(e[3]=p=>G(l)?l.value=p:null),w]},{default:n(()=>[s(R,{name:"all",tab:"全部消息"},{default:n(()=>[s(i(C),{onMarkAsRead:e[0]||(e[0]=p=>{b(p)}),data:i(r)},null,8,["data"])]),_:1}),s(R,{name:"system",tab:"系统消息"},{default:n(()=>[s(i(C),{onMarkAsRead:e[1]||(e[1]=p=>{b(p)}),data:i(r)},null,8,["data"])]),_:1}),s(R,{name:"user",tab:"用户消息"},{default:n(()=>[s(i(C),{onMarkAsRead:e[2]||(e[2]=p=>{b(p)}),data:i(r)},null,8,["data"])]),_:1})]),_:1},8,["value"])])]),_:1})])}}};export{W as default};
