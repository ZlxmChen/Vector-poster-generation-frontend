import{av as it,ad as at,T as G,H as z,I as w,J as K,a3 as C,K as J,L as k,R as Q,a6 as ht,a7 as ot,ac as R,aw as nt,ax as ft,M as D,a9 as Z,a2 as T}from"./index.9ba2f0f9.js";import{b as xt,p as tt,g as ct}from"./index.db9bc9a4.js";import{r as et}from"./___vite-browser-external_commonjs-proxy.6a231247.js";import{u as ut}from"./userStore.40f76c3f.js";var st={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2024
 * @license MIT
 */(function(q){(function(){var A="input is invalid type",M=typeof window=="object",d=M?window:{};d.JS_SHA256_NO_WINDOW&&(M=!1);var y=!M&&typeof self=="object",V=!d.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;V?d=it:y&&(d=self);var W=!d.JS_SHA256_NO_COMMON_JS&&!0&&q.exports,p=!d.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",i="0123456789abcdef".split(""),H=[-2147483648,8388608,32768,128],F=[24,16,8,0],B=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=["hex","array","digest","arrayBuffer"],c=[];(d.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"}),p&&(d.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(t){return typeof t=="object"&&t.buffer&&t.buffer.constructor===ArrayBuffer});var m=function(t,a){return function(h){return new l(a,!0).update(h)[t]()}},S=function(t){var a=m("hex",t);V&&(a=b(a,t)),a.create=function(){return new l(t)},a.update=function(o){return a.create().update(o)};for(var h=0;h<g.length;++h){var s=g[h];a[s]=m(s,t)}return a},b=function(t,a){var h=et,s=et.Buffer,o=a?"sha224":"sha256",r;s.from&&!d.JS_SHA256_NO_BUFFER_FROM?r=s.from:r=function(e){return new s(e)};var n=function(e){if(typeof e=="string")return h.createHash(o).update(e,"utf8").digest("hex");if(e==null)throw new Error(A);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===s?h.createHash(o).update(r(e)).digest("hex"):t(e)};return n},$=function(t,a){return function(h,s){return new I(h,a,!0).update(s)[t]()}},X=function(t){var a=$("hex",t);a.create=function(o){return new I(o,t)},a.update=function(o,r){return a.create(o).update(r)};for(var h=0;h<g.length;++h){var s=g[h];a[s]=$(s,t)}return a};function l(t,a){a?(c[0]=c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0,this.blocks=c):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=t}l.prototype.update=function(t){if(!this.finalized){var a,h=typeof t;if(h!=="string"){if(h==="object"){if(t===null)throw new Error(A);if(p&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!p||!ArrayBuffer.isView(t)))throw new Error(A)}else throw new Error(A);a=!0}for(var s,o=0,r,n=t.length,e=this.blocks;o<n;){if(this.hashed&&(this.hashed=!1,e[0]=this.block,this.block=e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),a)for(r=this.start;o<n&&r<64;++o)e[r>>>2]|=t[o]<<F[r++&3];else for(r=this.start;o<n&&r<64;++o)s=t.charCodeAt(o),s<128?e[r>>>2]|=s<<F[r++&3]:s<2048?(e[r>>>2]|=(192|s>>>6)<<F[r++&3],e[r>>>2]|=(128|s&63)<<F[r++&3]):s<55296||s>=57344?(e[r>>>2]|=(224|s>>>12)<<F[r++&3],e[r>>>2]|=(128|s>>>6&63)<<F[r++&3],e[r>>>2]|=(128|s&63)<<F[r++&3]):(s=65536+((s&1023)<<10|t.charCodeAt(++o)&1023),e[r>>>2]|=(240|s>>>18)<<F[r++&3],e[r>>>2]|=(128|s>>>12&63)<<F[r++&3],e[r>>>2]|=(128|s>>>6&63)<<F[r++&3],e[r>>>2]|=(128|s&63)<<F[r++&3]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.block=e[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},l.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,a=this.lastByteIndex;t[16]=this.block,t[a>>>2]|=H[a&3],this.block=t[16],a>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},l.prototype.hash=function(){var t=this.h0,a=this.h1,h=this.h2,s=this.h3,o=this.h4,r=this.h5,n=this.h6,e=this.h7,f=this.blocks,u,v,_,O,x,N,U,j,L,Y,P;for(u=16;u<64;++u)x=f[u-15],v=(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3,x=f[u-2],_=(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10,f[u]=f[u-16]+v+f[u-7]+_<<0;for(P=a&h,u=0;u<64;u+=4)this.first?(this.is224?(j=300032,x=f[0]-1413257819,e=x-150054599<<0,s=x+24177077<<0):(j=704751109,x=f[0]-210244248,e=x-1521486534<<0,s=x+143694565<<0),this.first=!1):(v=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),_=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),j=t&a,O=j^t&h^P,U=o&r^~o&n,x=e+_+U+B[u]+f[u],N=v+O,e=s+x<<0,s=x+N<<0),v=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),_=(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7),L=s&t,O=L^s&a^j,U=e&o^~e&r,x=n+_+U+B[u+1]+f[u+1],N=v+O,n=h+x<<0,h=x+N<<0,v=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),_=(n>>>6|n<<26)^(n>>>11|n<<21)^(n>>>25|n<<7),Y=h&s,O=Y^h&t^L,U=n&e^~n&o,x=r+_+U+B[u+2]+f[u+2],N=v+O,r=a+x<<0,a=x+N<<0,v=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),_=(r>>>6|r<<26)^(r>>>11|r<<21)^(r>>>25|r<<7),P=a&h,O=P^a&s^Y,U=r&n^~r&e,x=o+_+U+B[u+3]+f[u+3],N=v+O,o=t+x<<0,t=x+N<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+t<<0,this.h1=this.h1+a<<0,this.h2=this.h2+h<<0,this.h3=this.h3+s<<0,this.h4=this.h4+o<<0,this.h5=this.h5+r<<0,this.h6=this.h6+n<<0,this.h7=this.h7+e<<0},l.prototype.hex=function(){this.finalize();var t=this.h0,a=this.h1,h=this.h2,s=this.h3,o=this.h4,r=this.h5,n=this.h6,e=this.h7,f=i[t>>>28&15]+i[t>>>24&15]+i[t>>>20&15]+i[t>>>16&15]+i[t>>>12&15]+i[t>>>8&15]+i[t>>>4&15]+i[t&15]+i[a>>>28&15]+i[a>>>24&15]+i[a>>>20&15]+i[a>>>16&15]+i[a>>>12&15]+i[a>>>8&15]+i[a>>>4&15]+i[a&15]+i[h>>>28&15]+i[h>>>24&15]+i[h>>>20&15]+i[h>>>16&15]+i[h>>>12&15]+i[h>>>8&15]+i[h>>>4&15]+i[h&15]+i[s>>>28&15]+i[s>>>24&15]+i[s>>>20&15]+i[s>>>16&15]+i[s>>>12&15]+i[s>>>8&15]+i[s>>>4&15]+i[s&15]+i[o>>>28&15]+i[o>>>24&15]+i[o>>>20&15]+i[o>>>16&15]+i[o>>>12&15]+i[o>>>8&15]+i[o>>>4&15]+i[o&15]+i[r>>>28&15]+i[r>>>24&15]+i[r>>>20&15]+i[r>>>16&15]+i[r>>>12&15]+i[r>>>8&15]+i[r>>>4&15]+i[r&15]+i[n>>>28&15]+i[n>>>24&15]+i[n>>>20&15]+i[n>>>16&15]+i[n>>>12&15]+i[n>>>8&15]+i[n>>>4&15]+i[n&15];return this.is224||(f+=i[e>>>28&15]+i[e>>>24&15]+i[e>>>20&15]+i[e>>>16&15]+i[e>>>12&15]+i[e>>>8&15]+i[e>>>4&15]+i[e&15]),f},l.prototype.toString=l.prototype.hex,l.prototype.digest=function(){this.finalize();var t=this.h0,a=this.h1,h=this.h2,s=this.h3,o=this.h4,r=this.h5,n=this.h6,e=this.h7,f=[t>>>24&255,t>>>16&255,t>>>8&255,t&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255,o>>>24&255,o>>>16&255,o>>>8&255,o&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255];return this.is224||f.push(e>>>24&255,e>>>16&255,e>>>8&255,e&255),f},l.prototype.array=l.prototype.digest,l.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(this.is224?28:32),a=new DataView(t);return a.setUint32(0,this.h0),a.setUint32(4,this.h1),a.setUint32(8,this.h2),a.setUint32(12,this.h3),a.setUint32(16,this.h4),a.setUint32(20,this.h5),a.setUint32(24,this.h6),this.is224||a.setUint32(28,this.h7),t};function I(t,a,h){var s,o=typeof t;if(o==="string"){var r=[],n=t.length,e=0,f;for(s=0;s<n;++s)f=t.charCodeAt(s),f<128?r[e++]=f:f<2048?(r[e++]=192|f>>>6,r[e++]=128|f&63):f<55296||f>=57344?(r[e++]=224|f>>>12,r[e++]=128|f>>>6&63,r[e++]=128|f&63):(f=65536+((f&1023)<<10|t.charCodeAt(++s)&1023),r[e++]=240|f>>>18,r[e++]=128|f>>>12&63,r[e++]=128|f>>>6&63,r[e++]=128|f&63);t=r}else if(o==="object"){if(t===null)throw new Error(A);if(p&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!p||!ArrayBuffer.isView(t)))throw new Error(A)}else throw new Error(A);t.length>64&&(t=new l(a,!0).update(t).array());var u=[],v=[];for(s=0;s<64;++s){var _=t[s]||0;u[s]=92^_,v[s]=54^_}l.call(this,a,h),this.update(v),this.oKeyPad=u,this.inner=!0,this.sharedMemory=h}I.prototype=new l,I.prototype.finalize=function(){if(l.prototype.finalize.call(this),this.inner){this.inner=!1;var t=this.array();l.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(t),l.prototype.finalize.call(this)}};var E=S();E.sha256=E,E.sha224=S(!0),E.sha256.hmac=X(),E.sha224.hmac=X(!0),W?q.exports=E:(d.sha256=E.sha256,d.sha224=E.sha224)})()})(st);var rt=st.exports;const lt={class:"login-container"},Ft={class:"left-panel"},pt=["src"],dt={class:"right-panel"},vt={class:"login-card"},_t={class:"login-title"},bt={key:0},yt={key:1},St={__name:"login",setup(q){const A=at(),M=ut(),d=G([{id:1,src:"https://zzq-typora-picgo.oss-cn-beijing.aliyuncs.com/2024-fengru/svg/macaw.svg"},{id:2,src:"https://zzq-typora-picgo.oss-cn-beijing.aliyuncs.com/2024-fengru/svg/macaw.svg"},{id:3,src:"https://zzq-typora-picgo.oss-cn-beijing.aliyuncs.com/2024-fengru/svg/macaw.svg"},{id:4,src:"https://zzq-typora-picgo.oss-cn-beijing.aliyuncs.com/2024-fengru/svg/macaw.svg"},{id:5,src:"https://zzq-typora-picgo.oss-cn-beijing.aliyuncs.com/2024-fengru/svg/macaw.svg"}]),y=G(!0),V=(W,{email:p,password:i,username:H})=>{if(W)if(y.value)xt("/user/salt",{email:p},m=>{console.log(m.salt),tt("/user/login",{email:p,password:rt.sha256(i+m.salt)},S=>{T.Message.success("成功登录"),localStorage.setItem("Token",S.token),ct("/user/profile",{},b=>{console.log(b),M.setUser({id:b.id,username:b.username,email:b.email,gender:b.gender,avatarUrl:b.avatarUrl,registerTime:b.registerTime})}),A.push("/home")},S=>{T.Message.error("账号或密码错误，请重试")})},m=>{T.Message.error("登陆失败，请稍后重试")});else{for(var F="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",B=F.length,g="",c=0;c<20;c++)g+=F.charAt(Math.floor(Math.random()*B));tt("/user/register",{username:H,email:p,password:rt.sha256(i+g),salt:g},m=>{T.Message.success("成功注册"),y.value=!0},m=>{console.log(m),T.Message.error("注册失败，请稍后重试")})}};return(W,p)=>{const i=z("Button"),H=z("space"),F=z("Email"),B=z("UserName"),g=z("Password"),c=z("Submit"),m=z("Login",!0);return w(),K("div",lt,[C("div",Ft,[J(Q(ft),{autoplay:!0,"autoplay-timeout":2e3,perspective:0,space:400,display:3},{default:k(()=>[(w(!0),K(ht,null,ot(d.value,(S,b)=>(w(),R(Q(nt),{index:b,key:b},{default:k(()=>[C("img",{src:S.src,alt:"logo"},null,8,pt)]),_:2},1032,["index"]))),128))]),_:1})]),C("div",dt,[C("div",vt,[C("div",_t,[J(H,null,{default:k(()=>[y.value?(w(),K("h2",bt,"登录")):(w(),K("h2",yt,"注册")),y.value?(w(),R(i,{key:2,type:"dashed",onClick:p[0]||(p[0]=S=>y.value=!1)},{default:k(()=>[D("立即注册")]),_:1})):(w(),R(i,{key:3,type:"dashed",onClick:p[1]||(p[1]=S=>y.value=!0)},{default:k(()=>[D("立即登录")]),_:1}))]),_:1})]),J(m,{onOnSubmit:V},{default:k(()=>[J(F,{name:"email"}),y.value?Z("",!0):(w(),R(B,{key:0,name:"username"})),J(g,{name:"password"}),y.value?Z("",!0):(w(),R(g,{key:1,name:"passwordConfirm",placeholder:"确认密码"})),y.value?(w(),R(c,{key:2},{default:k(()=>[D("登录")]),_:1})):(w(),R(c,{key:3},{default:k(()=>[D("注册")]),_:1}))]),_:1})])])])}}};export{St as default};
